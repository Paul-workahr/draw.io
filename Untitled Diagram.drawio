<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36" version="29.0.3">
  <diagram name="Page-1" id="g4jnvGHt3v5Qdj6G8mIr">
    <mxGraphModel dx="2084" dy="1054" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="p8gdPbtD1B7Fc0XDnWvv-1" target="p8gdPbtD1B7Fc0XDnWvv-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-1" value="" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-2" value="voucher_header" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="70" y="95" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="p8gdPbtD1B7Fc0XDnWvv-3" target="p8gdPbtD1B7Fc0XDnWvv-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-3" value="jew_voucher_details" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="80" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="p8gdPbtD1B7Fc0XDnWvv-5" target="p8gdPbtD1B7Fc0XDnWvv-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-5" value="jew_item_components_log" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="440" y="80" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="p8gdPbtD1B7Fc0XDnWvv-7" target="p8gdPbtD1B7Fc0XDnWvv-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-7" value="ledgers_transactions" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="687" y="80" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="p8gdPbtD1B7Fc0XDnWvv-9" target="p8gdPbtD1B7Fc0XDnWvv-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-9" value="stock_items" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1150" y="80" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-11" value="jew_stock_item_transactions" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1410" y="80" width="270" height="60" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-27" value="&lt;div style=&quot;text-align: justify;&quot;&gt;JEWELLERY PURCHASE HAPPENS:&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;├─ 1. INSERT into voucher_header (master record)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ module_id = 3 (Jewellery)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ type_id = PURCHASE_TYPE&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ primary_ledger_id = Supplier Ledger (Sundry Creditor)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ secondary_ledger_id = Gold Purchase Ledger (from division)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ party_id = Supplier ID&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ total_gross_amount = Total purchase amount&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ total_net_amount = After tax&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;└─ Get voucher_id = 101&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;├─ 2. INSERT into jew_voucher_details (each item purchased)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ voucher_id = 101&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stock_division = 1 (G-GOLD)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stock_id = 501 (22K Chain)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stock_code = &quot;GOLD-CH-001&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stock_name = &quot;22K Gold Chain&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ piece = 1&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ gross_weight = 50.000g&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stone_weight = 2.500g&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ net_weight = 47.500g&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ metal_rate = 6500.00 per gram&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stone_rate = 500.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ metal_amount = 308750.00 (47.5 * 6500)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stone_amount = 1250.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ making_charges_amount = 15000.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ gross_amount = 325000.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ tax_percent = 5.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ tax_amount = 16250.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ net_amount = 341250.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ sales_ledger_id = 501 (Gold Sales - from division)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ purchase_ledger_id = 601 (Gold Purchase - from division)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;└─ Get voucher_detail_id = 1001&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;├─ 3. INSERT into jew_transaction_components_log (snapshot of masters)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ voucher_id = 101&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ voucher_detail_id = 1001&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ transaction_date = TODAY&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ karat_id = 1&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ karat_name = &quot;22 Karat&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ karat_purity = 91.67&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ division_id = 1&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ division_code = &quot;G&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ division_name = &quot;GOLD&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ division_purchase_ledger_id = 601&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ cost_centre_making_id = 5&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ making_charges_type = 1 (Per Gram)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ making_charges_rate = 300.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ gold_rate_22k = 6500.00 (TODAY&#39;s rate)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ tax_id = 1&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;└─ tax_percent = 5.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;├─ 4. INSERT into jew_stock_transaction (stock movement - IN)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ voucher_id = 101&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ voucher_detail_id = 1001&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ voucher_type = PURCHASE&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ voucher_no = &quot;PUR/2025/001&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ transaction_date = TODAY&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stock_id = 501&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stock_code = &quot;GOLD-CH-001&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stock_name = &quot;22K Gold Chain&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ division_id = 1&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ transaction_type = &#39;IN&#39; ⬅️ IMPORTANT&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ movement_type = 2 (Purchase)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ quantity = 1&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ gross_weight = 50.000&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stone_weight = 2.500&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ net_weight = 47.500&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ rate = 6500.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ metal_amount = 308750.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ stone_amount = 1250.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ making_charges = 15000.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ total_amount = 341250.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ party_id = 25 (Supplier)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ party_name = &quot;ABC Gold Suppliers&quot;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ -- CALCULATE RUNNING BALANCE:&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ Previous balance_qty = 5 pieces&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ New balance_qty = 5 + 1 = 6 pieces ⬅️&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ Previous balance_weight = 250.000g&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ New balance_weight = 250.000 + 50.000 = 300.000g ⬅️&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ Previous balance_value = 1,625,000.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;└─ New balance_value = 1,625,000 + 341250 = 1,966,250.00 ⬅️&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;├─ 5. UPDATE stock_items (increment stock)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ WHERE id = 501 (22K Chain)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ current_qty = current_qty + 1 (5 → 6) ⬆️&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ current_gross_total = current_gross_total + 341250.00 ⬆️&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ current_gross_weight = 250.000 + 50.000 = 300.000 ⬆️&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ current_net_weight = 237.500 + 47.500 = 285.000 ⬆️&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;└─ current_stone_weight = 12.500 + 2.500 = 15.000 ⬆️&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;├─ 6. INSERT into ledger_transactions (accounting entries)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ Entry 1: Purchase Ledger (Debit)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ voucher_id = 101&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ ledger_id = 601 (Gold Purchase)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ nature_type = &#39;Dr&#39;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ debit_amount = 341250.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ credit_amount = 0.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ module_id = 3 (Jewellery)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;└─ cost_center_id = 1 (G-GOLD division)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;├─ Entry 2: Tax Ledger (Debit - Input Tax)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ ledger_id = 801 (GST Input)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ nature_type = &#39;Dr&#39;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;├─ debit_amount = 16250.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&amp;nbsp; &amp;nbsp;└─ credit_amount = 0.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;│&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp;└─ Entry 3: Supplier Ledger (Credit)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;├─ ledger_id = 150 (ABC Gold Suppliers)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;├─ nature_type = &#39;Cr&#39;&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;├─ debit_amount = 0.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;└─ credit_amount = 357500.00 (341250 + 16250)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;│&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;└─ 7. INSERT into tax_transactions (tax tracking)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; ├─ voucher_id = 101&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; ├─ voucher_type = PURCHASE&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; ├─ tax_ledger_id = 801 (GST Input)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; ├─ party_ledger_id = 150 (Supplier)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; ├─ tax_percent = 5.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; ├─ taxable_amount = 325000.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; ├─ tax_amount = 16250.00&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; ├─ tax_type = &#39;INPUT&#39; ⬅️ IMPORTANT (for VAT report)&lt;/div&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&amp;nbsp; &amp;nbsp; └─ transaction_category = &#39;Gold&#39;&lt;/div&gt;" style="whiteSpace=wrap;html=1;aspect=fixed;align=left;" vertex="1" parent="1">
          <mxGeometry x="40" y="390" width="1860" height="1860" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-32" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="p8gdPbtD1B7Fc0XDnWvv-28" target="p8gdPbtD1B7Fc0XDnWvv-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-28" value="tax_transactions" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="900" y="80" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="p8gdPbtD1B7Fc0XDnWvv-33" value="JEWELLERY SALE HAPPENS (POS):&#xa;├─ 1. INSERT into voucher_header (master record)&#xa;│   ├─ module_id = 3 (Jewellery)&#xa;│   ├─ type_id = SALES_TYPE&#xa;│   ├─ bill_type = 1 (Sale)&#xa;│   ├─ primary_ledger_id = Customer Ledger (Sundry Debtor)&#xa;│   ├─ secondary_ledger_id = Gold Sales Ledger (from division)&#xa;│   ├─ party_id = Customer ID&#xa;│   ├─ salesman_id = 10 (From SALESMAN_MASTER)&#xa;│   ├─ total_gross_amount = Total sale amount&#xa;│   ├─ making_charges_total = 18000.00&#xa;│   ├─ stone_charges_total = 1500.00&#xa;│   ├─ total_net_amount = After tax&#xa;│   ├─ payment_mode = 1 (Cash)&#xa;│   ├─ cash_amount = 400000.00&#xa;│   └─ Get voucher_id = 201&#xa;│&#xa;├─ 2. INSERT into jew_voucher_details (each item sold)&#xa;│   ├─ voucher_id = 201&#xa;│   ├─ stock_division = 1 (G-GOLD)&#xa;│   ├─ stock_id = 501 (22K Chain)&#xa;│   ├─ stock_code = &quot;GOLD-CH-001&quot;&#xa;│   ├─ stock_name = &quot;22K Gold Chain&quot;&#xa;│   ├─ piece = 1&#xa;│   ├─ gross_weight = 50.000g&#xa;│   ├─ stone_weight = 2.500g&#xa;│   ├─ net_weight = 47.500g&#xa;│   ├─ metal_rate = 7000.00 per gram (SELLING rate)&#xa;│   ├─ stone_rate = 600.00&#xa;│   ├─ metal_amount = 332500.00 (47.5 * 7000)&#xa;│   ├─ stone_amount = 1500.00&#xa;│   ├─ making_charges_amount = 18000.00&#xa;│   ├─ gross_amount = 352000.00&#xa;│   ├─ discount_percent = 2.00&#xa;│   ├─ discount_amount = 7040.00&#xa;│   ├─ total_metal_stone_amount = 344960.00&#xa;│   ├─ tax_percent = 5.00&#xa;│   ├─ tax_amount = 17248.00&#xa;│   ├─ net_amount = 362208.00&#xa;│   ├─ sales_ledger_id = 501 (Gold Sales - from division)&#xa;│   ├─ purchase_ledger_id = 601 (Gold Purchase - from division)&#xa;│   ├─ karat_id = 1&#xa;│   ├─ karat_value = &quot;22K&quot;&#xa;│   ├─ purity = 91.67&#xa;│   └─ Get voucher_detail_id = 2001&#xa;│&#xa;├─ 3. INSERT into jew_transaction_components_log (snapshot of masters)&#xa;│   ├─ voucher_id = 201&#xa;│   ├─ voucher_detail_id = 2001&#xa;│   ├─ transaction_date = TODAY&#xa;│   ├─ karat_id = 1&#xa;│   ├─ karat_name = &quot;22 Karat&quot;&#xa;│   ├─ karat_purity = 91.67&#xa;│   ├─ division_id = 1&#xa;│   ├─ division_code = &quot;G&quot;&#xa;│   ├─ division_name = &quot;GOLD&quot;&#xa;│   ├─ division_sales_ledger_id = 501&#xa;│   ├─ cost_centre_making_id = 5&#xa;│   ├─ making_charges_type = 1 (Per Gram)&#xa;│   ├─ making_charges_rate = 360.00 (SELLING rate)&#xa;│   ├─ gold_rate_22k = 7000.00 (TODAY&#39;s SELLING rate)&#xa;│   ├─ tax_id = 1&#xa;│   └─ tax_percent = 5.00&#xa;│&#xa;├─ 4. INSERT into jew_stock_transaction (stock movement - OUT)&#xa;│   ├─ voucher_id = 201&#xa;│   ├─ voucher_detail_id = 2001&#xa;│   ├─ voucher_type = SALES&#xa;│   ├─ voucher_no = &quot;POS/2025/001&quot;&#xa;│   ├─ transaction_date = TODAY&#xa;│   ├─ stock_id = 501&#xa;│   ├─ stock_code = &quot;GOLD-CH-001&quot;&#xa;│   ├─ stock_name = &quot;22K Gold Chain&quot;&#xa;│   ├─ division_id = 1&#xa;│   ├─ transaction_type = &#39;OUT&#39; ⬅️ IMPORTANT&#xa;│   ├─ movement_type = 1 (Sale)&#xa;│   ├─ quantity = 1&#xa;│   ├─ gross_weight = 50.000&#xa;│   ├─ stone_weight = 2.500&#xa;│   ├─ net_weight = 47.500&#xa;│   ├─ rate = 7000.00&#xa;│   ├─ metal_amount = 332500.00&#xa;│   ├─ stone_amount = 1500.00&#xa;│   ├─ making_charges = 18000.00&#xa;│   ├─ total_amount = 362208.00&#xa;│   ├─ party_id = 50 (Customer)&#xa;│   ├─ party_name = &quot;John Doe&quot;&#xa;│   ├─ -- CALCULATE RUNNING BALANCE:&#xa;│   ├─ Previous balance_qty = 6 pieces&#xa;│   ├─ New balance_qty = 6 - 1 = 5 pieces ⬅️&#xa;│   ├─ Previous balance_weight = 300.000g&#xa;│   ├─ New balance_weight = 300.000 - 50.000 = 250.000g ⬅️&#xa;│   ├─ Previous balance_value = 1,966,250.00&#xa;│   └─ New balance_value = 1,966,250 - 341250 = 1,625,000.00 ⬅️&#xa;│&#xa;├─ 5. UPDATE stock_items (decrement stock)&#xa;│   ├─ WHERE id = 501 (22K Chain)&#xa;│   ├─ current_qty = current_qty - 1 (6 → 5) ⬇️&#xa;│   ├─ current_gross_total = current_gross_total - 341250.00 ⬇️&#xa;│   ├─ current_gross_weight = 300.000 - 50.000 = 250.000 ⬇️&#xa;│   ├─ current_net_weight = 285.000 - 47.500 = 237.500 ⬇️&#xa;│   └─ current_stone_weight = 15.000 - 2.500 = 12.500 ⬇️&#xa;│&#xa;├─ 6. INSERT into ledger_transactions (accounting entries)&#xa;│   ├─ Entry 1: Customer Ledger (Debit)&#xa;│   │   ├─ voucher_id = 201&#xa;│   │   ├─ ledger_id = 250 (John Doe - Customer)&#xa;│   │   ├─ nature_type = &#39;Dr&#39;&#xa;│   │   ├─ debit_amount = 362208.00&#xa;│   │   ├─ credit_amount = 0.00&#xa;│   │   └─ module_id = 3 (Jewellery)&#xa;│   │&#xa;│   ├─ Entry 2: Sales Ledger (Credit - Metal)&#xa;│   │   ├─ ledger_id = 501 (Gold Jewellery Sales - from division)&#xa;│   │   ├─ nature_type = &#39;Cr&#39;&#xa;│   │   ├─ debit_amount = 0.00&#xa;│   │   ├─ credit_amount = 334000.00 (metal + stone)&#xa;│   │   ├─ module_id = 3&#xa;│   │   ├─ stock_id = 501&#xa;│   │   └─ cost_center_id = 1 (G-GOLD division)&#xa;│   │&#xa;│   ├─ Entry 3: Making Charges Income (Credit)&#xa;│   │   ├─ ledger_id = 504 (Making Charges Income)&#xa;│   │   ├─ nature_type = &#39;Cr&#39;&#xa;│   │   ├─ debit_amount = 0.00&#xa;│   │   └─ credit_amount = 18000.00&#xa;│   │&#xa;│   ├─ Entry 4: Discount (Debit)&#xa;│   │   ├─ ledger_id = 705 (Discount Given)&#xa;│   │   ├─ nature_type = &#39;Dr&#39;&#xa;│   │   ├─ debit_amount = 7040.00&#xa;│   │   └─ credit_amount = 0.00&#xa;│   │&#xa;│   └─ Entry 5: Tax Ledger (Credit - Output Tax)&#xa;│       ├─ ledger_id = 802 (GST Output)&#xa;│       ├─ nature_type = &#39;Cr&#39;&#xa;│       ├─ debit_amount = 0.00&#xa;│       └─ credit_amount = 17248.00&#xa;│&#xa;└─ 7. INSERT into tax_transactions (tax tracking)&#xa;    ├─ voucher_id = 201&#xa;    ├─ voucher_type = SALES&#xa;    ├─ tax_ledger_id = 802 (GST Output)&#xa;    ├─ party_ledger_id = 250 (Customer)&#xa;    ├─ tax_percent = 5.00&#xa;    ├─ taxable_amount = 344960.00&#xa;    ├─ tax_amount = 17248.00&#xa;    ├─ tax_type = &#39;OUTPUT&#39; ⬅️ IMPORTANT (for VAT report)&#xa;    └─ transaction_category = &#39;Gold&#39;" style="whiteSpace=wrap;html=1;aspect=fixed;align=left;" vertex="1" parent="1">
          <mxGeometry x="40" y="2350" width="2410" height="2410" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
